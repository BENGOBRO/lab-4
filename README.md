# Лабораторная работа №4

## Обзор
Сервис GitLab требует верификации аккаунта для запуска CI/CD пайплайнов, а верификация заключается в предоставлении данных зарубежных банковской карты и номера телефона.
В связи с невозможностью верифицировать аккаунт был выбран сервис GitHub и Actions для настройки пайплайна, так как в нем не требуется верифицировать аккаунт таким образом.

## Проект
Для выполнения работы был использован старый pet-проект, в котором ранее настраивался пайплайн.

## Стек технологий
- Java 17
- Spring Boot 3
- Gradle - система сборки проекта
- Lombok

## Выполнение работы
### Задачи в пайплайне
В пайплайне будут выполняться следующие задачи: сборка проекта, упаковка в docker-образ, отправка образа в Docker Hub.
Так как у меня нет сервера, этап деплоя сервиса из Docker Hub на сервер производиться не будет.

### Работа с Actions
Для работы GitHub Actions необходим файл .github/workflow/<имя>.yml. 
Тогда Actions автоматически будет читать этот файл.
Actions использует специфический синтаксис для описания .yml файлов, поэтому, для начала работы необходимо изучить официальную документацию.
В .yml файле необходимо задать имя процесса (name).
С помощью строки on мы задаем события, при которых будет запускаться пайплайн.
В нашем случае пайплайн будет запускаться при push и pull request с веткой main.
Задачи, которые будут выполняться пайплайном, указываются через строку jobs.
*Все дальнейшие шаги, связанные с настройкой окружения, описаны в main.yml.*

Также можно использовать заготовленные скрипты из Actions Marketplace для ускорения процесса написания пайплайна.
В этой работе будут использованы скрипты из наборов actions/checkout@v3, actions/setup-java@v3, gradle/gradle-build-action@v2, docker/login-action@v3

actions/checkout@v3 - набор скриптов для настройки Git репозитория внутри виртуальной машины
![image](https://github.com/user-attachments/assets/2419a7e7-ea94-4824-a01d-23f0f18b615d)

actions/setup-java@v3 - набор скриптов для настройки окружения java
![image](https://github.com/user-attachments/assets/22cf259a-77a4-46ce-a3bb-966ee10561b7)

actions/gradle-build-action@v2 - набор скриптов для настройки Gradle
![image](https://github.com/user-attachments/assets/878a795f-2a91-41fe-b6b9-b03a9ba1c8cd)

docker/login-action@v3 - набор скриптов для аутентификации и авторизации в сервисе Docker Hub
![image](https://github.com/user-attachments/assets/1c9e9441-42c3-4ac0-8214-7bf8422fae54)

Перед выполнением этих шагов неявно отрабатывает шаг настройки виртуальной машины
![image](https://github.com/user-attachments/assets/b030d398-0cd7-446e-ac5a-28b93cf8cccb)

После выполнения всех шагов неявным образов выполняются шаги по остановке всех запущенных утилит в шагах, а также выхода из Docker Hub.
Помимо этого завершается работа виртуальной машины.
![image](https://github.com/user-attachments/assets/64eb71db-b2f4-4c21-ac4a-aa381fe8e8da)

После завершения пайплайна мы можем заново запустить пайплайн, а в случае падения одного из шагов, можем перезапустить пайплайн с конкретным шагом выполнения.

### Плохой main.yml


### Хорший main.yml
